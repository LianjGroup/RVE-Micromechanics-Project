
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Bingham Distribution</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-05-21"><meta name="DC.source" content="script_BinghamODFs.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Bingham Distribution</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Theory</a></li><li><a href="#5">The bipolar case and unimodal distribution</a></li><li><a href="#9">TODO</a></li><li><a href="#12">Prolate case and fibre distribution</a></li><li><a href="#19">Oblate case</a></li></ul></div><h2 id="1">Theory</h2><p>The Bingham distribution has the density function</p><p><img src="BinghamODFs_eq00921948849648855568.png" alt="$$ f(g;K,U) = _1\!F_1 \left(\frac{1}{2},2,K \right)^{-1} \exp&#xA;\left\{ g^T UKU  g \right\},\qquad g\in S^3, $$"></p><p>where <img src="BinghamODFs_eq04054596528756220535.png" alt="$U$"> is an <img src="BinghamODFs_eq08932286224937509771.png" alt="$4 \times 4$"> orthogonal matrix with unit quaternions <img src="BinghamODFs_eq12682174343046702632.png" alt="$u_{1,..,4}\in S^3$"> in the columns and <img src="BinghamODFs_eq14155762934034653800.png" alt="$K$"> is a <img src="BinghamODFs_eq08932286224937509771.png" alt="$4 \times 4$"> diagonal matrix with the entries <img src="BinghamODFs_eq09425376041930734468.png" alt="$k_1,..,k_4$"> describing the shape of the distribution. <img src="BinghamODFs_eq01145617313262702035.png" alt="$_1F_1(\cdot,\cdot,\cdot)$"> is the hypergeometric function with matrix argument normalizing the density.</p><p>The shape parameters <img src="BinghamODFs_eq12394103933680550556.png" alt="$k_1 \ge k_2 \ge k_3 \ge k_4$"> give</p><div><ul><li>a <i>bipolar</i>   distribution, if <img src="BinghamODFs_eq02421972113606052777.png" alt="$k_1 + k_4 &gt; k_2 + k_3$">,</li><li>a <i>circular</i>  distribution, if <img src="BinghamODFs_eq00988386148271731055.png" alt="$k_1 + k_4 = k_2 + k_3$">,</li><li>a <i>spherical</i> distribution, if <img src="BinghamODFs_eq06569158768061465732.png" alt="$k_1 + k_4 < k_2 + k_3$">,</li><li>a <i>uniform</i>  distribution, if <img src="BinghamODFs_eq05328760591829432846.png" alt="$k_1 = k_2 = k_3 = k_4$">,</li></ul></div><p>The general setup of the Bingham distribution in MTEX is done as follows</p><pre class="codeinput">cs = crystalSymmetry(<span class="string">'1'</span>);

kappa = [100 90 80 0];   <span class="comment">% shape parameters</span>
U     = eye(4);          <span class="comment">% orthogonal matrix</span>

odf = BinghamODF(kappa,U,cs)
</pre><pre class="codeoutput"> 
odf = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 100 90 80 0
  weight: 1
 
</pre><pre class="codeinput">h = [Miller(0,0,1,cs) Miller(1,0,0,cs) Miller(1,1,1,cs)];
plotPDF(odf,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>);
</pre><img vspace="50" hspace="5" src="BinghamODFs_01.png" alt=""> <pre class="codeinput">plot(odf,<span class="string">'sections'</span>,6)
</pre><img vspace="50" hspace="5" src="BinghamODFs_02.png" alt=""> <h2 id="5">The bipolar case and unimodal distribution</h2><p>First, we define some unimodal odf</p><pre class="codeinput">odf_spherical = unimodalODF(orientation.rand(cs),<span class="string">'halfwidth'</span>,20*degree)
</pre><pre class="codeoutput"> 
odf_spherical = SO3FunRBF (1 &#8594; xyz)
 
  &lt;strong&gt;unimodal component&lt;/strong&gt;
  kernel: de la Vallee Poussin, halfwidth 20&deg;
  center: 1 orientations
 
  Bunge Euler angles in degree
     phi1     Phi    phi2  weight
  144.167 123.701 42.6803       1
 
</pre><pre class="codeinput">plotPDF(odf_spherical,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>)
</pre><img vspace="50" hspace="5" src="BinghamODFs_03.png" alt=""> <p>Next, we simulate individual orientations from this odf, in a scattered axis/angle plot in which the simulated data looks like a sphere</p><pre class="codeinput">ori_spherical = discreteSample(odf_spherical,1000);
close <span class="string">all</span>
scatter(ori_spherical)
</pre><img vspace="50" hspace="5" src="BinghamODFs_04.png" alt=""> <p>From this simulated EBSD data, we can estimate the parameters of the Bingham distribution,</p><pre class="codeinput">odf_est = calcBinghamODF(ori_spherical)

plotPDF(odf_est,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>)
</pre><pre class="codeoutput"> 
odf_est = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 0 0.58 3.9 26
  weight: 1
 
</pre><img vspace="50" hspace="5" src="BinghamODFs_05.png" alt=""> <h2 id="9">TODO</h2><p>where <tt>U</tt> is the orthogonal matrix of eigenvectors of the orientation tensor and <tt>kappa</tt> the shape parameters associated with the <tt>U</tt>.</p><p>next, we test the different cases of the distribution on rejection</p><pre class="codeinput"><span class="comment">%T_spherical = bingham_test(ori_spherical,'spherical','approximated');</span>
<span class="comment">%T_oblate    = bingham_test(ori_spherical,'prolate',  'approximated');</span>
<span class="comment">%T_prolate   = bingham_test(ori_spherical,'oblate',   'approximated');</span>

<span class="comment">%t = [T_spherical T_oblate T_prolate]</span>
</pre><p>The spherical test case failed to reject for some level of significance, hence we would dismiss the hypothesis prolate and oblate.</p><pre class="codeinput"><span class="comment">%df_spherical = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)</span>
</pre><pre class="codeinput"><span class="comment">%plotPDF(odf_spherical,h,'antipodal','silent')</span>
</pre><h2 id="12">Prolate case and fibre distribution</h2><p>The prolate case correspondes to a fibre.</p><pre class="codeinput">odf_prolate = fibreODF(Miller(0,0,1,crystalSymmetry(<span class="string">'1'</span>)),zvector,<span class="keyword">...</span>
  <span class="string">'halfwidth'</span>,20*degree)
</pre><pre class="codeoutput"> 
odf_prolate = SO3FunCBF (1 &#8594; xyz)
 
  kernel: de la Vallee Poussin, halfwidth 20&deg;
  fibre : (001) || 0,0,1
  weight: 1
 
</pre><pre class="codeinput">plotPDF(odf_prolate,h,<span class="string">'upper'</span>,<span class="string">'silent'</span>)
</pre><img vspace="50" hspace="5" src="BinghamODFs_06.png" alt=""> <p>As before, we generate some random orientations from a model odf. The shape in an axis/angle scatter plot reminds of a cigar</p><pre class="codeinput">ori_prolate = discreteSample(odf_prolate,1000);
close <span class="string">all</span>
scatter(ori_prolate)
</pre><img vspace="50" hspace="5" src="BinghamODFs_07.png" alt=""> <p>We estimate the parameters of the Bingham distribution</p><pre class="codeinput">calcBinghamODF(ori_prolate)
</pre><pre class="codeoutput"> 
ans = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 0 5.3 51 52
  weight: 1
 
</pre><p>and test on the three cases</p><pre class="codeinput"><span class="comment">%T_spherical = bingham_test(ori_prolate,'spherical','approximated');</span>
<span class="comment">%T_oblate    = bingham_test(ori_prolate,'prolate',  'approximated');</span>
<span class="comment">%T_prolate   = bingham_test(ori_prolate,'oblate',   'approximated');</span>

<span class="comment">%t = [T_spherical T_oblate T_prolate]</span>
</pre><p>The test clearly rejects the spherical and prolate case, but not the prolate. We construct the Bingham distribution from the parameters, it might show some skewness</p><pre class="codeinput">odf_prolate = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)
</pre><pre class="codeoutput"> 
odf_prolate = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 100 90 80 0
  weight: 1
 
</pre><pre class="codeinput">plotPDF(odf_prolate,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>)
</pre><img vspace="50" hspace="5" src="BinghamODFs_08.png" alt=""> <h2 id="19">Oblate case</h2><p>The oblate case of the Bingham distribution has no direct counterpart in terms of texture components, thus we can construct it straightforward</p><pre class="codeinput">odf_oblate = BinghamODF([50 50 50 0],eye(4),crystalSymmetry,specimenSymmetry)
</pre><pre class="codeoutput"> 
odf_oblate = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 50 50 50 0
  weight: 1
 
</pre><pre class="codeinput">plotPDF(odf_oblate,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>)
</pre><img vspace="50" hspace="5" src="BinghamODFs_09.png" alt=""> <p>The oblate cases in axis/angle space remind on a disk</p><pre class="codeinput">ori_oblate = discreteSample(odf_oblate,1000);
close <span class="string">all</span>
scatter(ori_oblate)
</pre><img vspace="50" hspace="5" src="BinghamODFs_10.png" alt=""> <p>We estimate the parameters again</p><pre class="codeinput">calcBinghamODF(ori_oblate)
</pre><pre class="codeoutput"> 
ans = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 0 50 50 52
  weight: 1
 
</pre><p>and do the tests</p><pre class="codeinput"><span class="comment">%T_spherical = bingham_test(ori_oblate,'spherical','approximated');</span>
<span class="comment">%T_oblate    = bingham_test(ori_oblate,'prolate',  'approximated');</span>
<span class="comment">%T_prolate   = bingham_test(ori_oblate,'oblate',   'approximated');</span>

<span class="comment">%t = [T_spherical T_oblate T_prolate]</span>
</pre><p>the spherical and oblate case are clearly rejected, the prolate case failed to reject for some level of significance</p><pre class="codeinput">odf_oblate = BinghamODF(kappa, U,crystalSymmetry,specimenSymmetry)
</pre><pre class="codeoutput"> 
odf_oblate = SO3FunBingham (1 &#8594; xyz)
 
  kappa: 100 90 80 0
  weight: 1
 
</pre><pre class="codeinput">plotPDF(odf_oblate,h,<span class="string">'antipodal'</span>,<span class="string">'silent'</span>)
</pre><img vspace="50" hspace="5" src="BinghamODFs_11.png" alt=""> <p><b>Bingham unimodal ODF</b></p><pre class="codeinput"><span class="comment">% a modal orientation</span>
cs = crystalSymmetry(<span class="string">'-3m'</span>);
mod = orientation.byEuler(45*degree,0*degree,0*degree,cs);

<span class="comment">% the corresponding Bingham ODF</span>
odf = BinghamODF(20,mod)

plot(odf,<span class="string">'sections'</span>,6,<span class="string">'silent'</span>,<span class="string">'contourf'</span>,<span class="string">'sigma'</span>)
</pre><pre class="codeoutput"> 
odf = SO3FunBingham (-3m1 &#8594; xyz)
 
  kappa: 20 0 0 0
  weight: 1
 
</pre><img vspace="50" hspace="5" src="BinghamODFs_12.png" alt=""> <p><b>Bingham fibre ODF</b></p><pre class="codeinput">odf = BinghamODF([-10,-10,10,10],quaternion(eye(4)),cs)

plot(odf,<span class="string">'sections'</span>,6,<span class="string">'silent'</span>,<span class="string">'sigma'</span>)
</pre><pre class="codeoutput"> 
odf = SO3FunBingham (-3m1 &#8594; xyz)
 
  kappa: -10 -10 10 10
  weight: 1
 
</pre><img vspace="50" hspace="5" src="BinghamODFs_13.png" alt=""> <p><b>Bingham spherical ODF</b></p><pre class="codeinput">odf = BinghamODF([-10,10,10,10],quaternion(eye(4)),cs)

plot(odf,<span class="string">'sections'</span>,6,<span class="string">'silent'</span>,<span class="string">'sigma'</span>);
</pre><pre class="codeoutput"> 
odf = SO3FunBingham (-3m1 &#8594; xyz)
 
  kappa: -10 10 10 10
  weight: 1
 
</pre><img vspace="50" hspace="5" src="BinghamODFs_14.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Bingham Distribution
%
%% Theory
%
% The Bingham distribution has the density function
%
% $$ f(g;K,U) = _1\!F_1 \left(\frac{1}{2},2,K \right)^{-1} \exp
% \left\{ g^T UKU  g \right\},\qquad g\in S^3, $$
%
% where $U$ is an $4 \times 4$ orthogonal matrix with unit quaternions
% $u_{1,..,4}\in S^3$ in the columns and $K$ is a $4 \times 4$ diagonal matrix
% with the entries $k_1,..,k_4$ describing the shape of the distribution.
% $_1F_1(\cdot,\cdot,\cdot)$ is the hypergeometric function with matrix
% argument normalizing the density.
%
% The shape parameters $k_1 \ge k_2 \ge k_3 \ge k_4$ give
%
% * a _bipolar_   distribution, if $k_1 + k_4 > k_2 + k_3$,
% * a _circular_  distribution, if $k_1 + k_4 = k_2 + k_3$,
% * a _spherical_ distribution, if $k_1 + k_4 < k_2 + k_3$,
% * a _uniform_  distribution, if $k_1 = k_2 = k_3 = k_4$,
%
%%
% The general setup of the Bingham distribution in MTEX is done as follows

cs = crystalSymmetry('1');

kappa = [100 90 80 0];   % shape parameters
U     = eye(4);          % orthogonal matrix

odf = BinghamODF(kappa,U,cs)

%%
%

h = [Miller(0,0,1,cs) Miller(1,0,0,cs) Miller(1,1,1,cs)];
plotPDF(odf,h,'antipodal','silent');

%%
%
plot(odf,'sections',6)

%% The bipolar case and unimodal distribution
% First, we define some unimodal odf

odf_spherical = unimodalODF(orientation.rand(cs),'halfwidth',20*degree)

%%
%

plotPDF(odf_spherical,h,'antipodal','silent')

%%
% Next, we simulate individual orientations from this odf, in a scattered
% axis/angle plot in which the simulated data looks like a sphere

ori_spherical = discreteSample(odf_spherical,1000);
close all
scatter(ori_spherical)

%%
% From this simulated EBSD data, we can estimate the parameters of the
% Bingham distribution,

odf_est = calcBinghamODF(ori_spherical)

plotPDF(odf_est,h,'antipodal','silent')

%% TODO
% 
% where |U| is the orthogonal matrix of eigenvectors of the orientation
% tensor and |kappa| the shape parameters associated with the |U|.
%
% next, we test the different cases of the distribution on rejection

%T_spherical = bingham_test(ori_spherical,'spherical','approximated');
%T_oblate    = bingham_test(ori_spherical,'prolate',  'approximated');
%T_prolate   = bingham_test(ori_spherical,'oblate',   'approximated');

%t = [T_spherical T_oblate T_prolate]

%%
% The spherical test case failed to reject for some level of
% significance, hence we would dismiss the hypothesis prolate and oblate.

%df_spherical = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)

%%
%

%plotPDF(odf_spherical,h,'antipodal','silent')

%% Prolate case and fibre distribution
% The prolate case correspondes to a fibre.

odf_prolate = fibreODF(Miller(0,0,1,crystalSymmetry('1')),zvector,...
  'halfwidth',20*degree)

%%
%

plotPDF(odf_prolate,h,'upper','silent')

%%
% As before, we generate some random orientations from a model odf. The
% shape in an axis/angle scatter plot reminds of a cigar

ori_prolate = discreteSample(odf_prolate,1000);
close all
scatter(ori_prolate)

%%
% We estimate the parameters of the Bingham distribution

calcBinghamODF(ori_prolate)

%%
% and test on the three cases

%T_spherical = bingham_test(ori_prolate,'spherical','approximated');
%T_oblate    = bingham_test(ori_prolate,'prolate',  'approximated');
%T_prolate   = bingham_test(ori_prolate,'oblate',   'approximated');

%t = [T_spherical T_oblate T_prolate]

%%
% The test clearly rejects the spherical and prolate case, but not the
% prolate. We construct the Bingham distribution from the parameters, it
% might show some skewness

odf_prolate = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)

%%
%

plotPDF(odf_prolate,h,'antipodal','silent')

%% Oblate case
% The oblate case of the Bingham distribution has no direct counterpart in
% terms of texture components, thus we can construct it straightforward

odf_oblate = BinghamODF([50 50 50 0],eye(4),crystalSymmetry,specimenSymmetry)

%%
%

plotPDF(odf_oblate,h,'antipodal','silent')

  %%
% The oblate cases in axis/angle space remind on a disk 

ori_oblate = discreteSample(odf_oblate,1000);
close all
scatter(ori_oblate)

%%
% We estimate the parameters again

calcBinghamODF(ori_oblate)

%%
% and do the tests

%T_spherical = bingham_test(ori_oblate,'spherical','approximated');
%T_oblate    = bingham_test(ori_oblate,'prolate',  'approximated');
%T_prolate   = bingham_test(ori_oblate,'oblate',   'approximated');

%t = [T_spherical T_oblate T_prolate]

%%
% the spherical and oblate case are clearly rejected, the prolate case
% failed to reject for some level of significance

odf_oblate = BinghamODF(kappa, U,crystalSymmetry,specimenSymmetry)

%%
%

plotPDF(odf_oblate,h,'antipodal','silent')


%%
% *Bingham unimodal ODF*

% a modal orientation
cs = crystalSymmetry('-3m');
mod = orientation.byEuler(45*degree,0*degree,0*degree,cs);

% the corresponding Bingham ODF
odf = BinghamODF(20,mod)

plot(odf,'sections',6,'silent','contourf','sigma')

%%
% *Bingham fibre ODF*

odf = BinghamODF([-10,-10,10,10],quaternion(eye(4)),cs)

plot(odf,'sections',6,'silent','sigma')

%%
% *Bingham spherical ODF*


odf = BinghamODF([-10,10,10,10],quaternion(eye(4)),cs)

plot(odf,'sections',6,'silent','sigma');
##### SOURCE END #####
--></body></html>