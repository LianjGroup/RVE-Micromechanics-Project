
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Import from VPSC</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-05-21"><meta name="DC.source" content="script_VPSCImport.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Import from VPSC</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Import the orientations generated by VPSC</a></li><li><a href="#6">Compare pole figures during deformation</a></li><li><a href="#7">Visualize slip system activity</a></li></ul></div><p><a href="https://public.lanl.gov/lebenso/">VPSC</a> is a crystal plasticity code originally written by Ricardo Lebensohn and Carlos Tome from Los Alamos National Laboratory - USA.</p><p>Original code can be requested to <a href="mailto:lebenso@lanl.gov">lebenso@lanl.gov</a></p><p><a href="https://public.lanl.gov/lebenso/">https://public.lanl.gov/lebenso/</a></p><h2 id="2">Import the orientations generated by VPSC</h2><p>Running a simulation in VPSC ussually results in an output file <tt>TEX_PH1.OUT</tt> which contains multiple sets of orientations for different strain levels. As these files does not contain any information on the crystal symmetry we need to specify it first</p><pre class="codeinput">cs = crystalSymmetry(<span class="string">'222'</span>, [4.762 10.225 5.994],<span class="string">'mineral'</span>, <span class="string">'olivine'</span>);
</pre><p>In the next step the orientations are imported and converted into a list of <a href="SO3Fun.SO3Fun.html">ODFs</a> using the command <a href="ODF.load.html"><tt>ODF.load</tt></a>.</p><pre class="codeinput"><span class="comment">% put in here the path to the VPSC output files</span>
path2file = [mtexDataPath filesep <span class="string">'VPSC'</span>];

odf = ODF.load([path2file filesep <span class="string">'TEX_PH1.OUT'</span>],<span class="string">'halfwidth'</span>,10*degree,<span class="string">'CS'</span>,cs)
</pre><pre class="codeoutput">Warning: The class ODF and also ODF.load is depreciated. Please
use instead SO3Fun.load 
odf =
  1&times;9 cell array
  Columns 1 through 3
    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}
  Columns 4 through 6
    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}
  Columns 7 through 9
    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}    {1&times;1 SO3FunHarmonic}
</pre><p>The individuel ODFs can be accessed by <tt>odf{id}</tt></p><pre class="codeinput"><span class="comment">% lets plot the second ODF</span>
plotSection(odf{2},<span class="string">'sigma'</span>,<span class="string">'figSize'</span>,<span class="string">'normal'</span>)
</pre><img vspace="50" hspace="5" src="VPSCImport_01.png" alt=""> <p>The information about the strain are stored as additional properties within each ODF variable</p><pre class="codeinput">odf{1}.opt
</pre><pre class="codeoutput">ans = 
  struct with fields:

                   strain: 0.2500
          strainEllipsoid: [1.1230 1.1270 0.7500]
    strainEllipsoidAngles: [-180 90 -180]
             orientations: [1000&times;1 orientation]
                     data: [1000&times;3 double]
</pre><h2 id="6">Compare pole figures during deformation</h2><p>Next we examine the evaluation of the ODF during the deformation by plotting strain depended pole figures.</p><pre class="codeinput"><span class="comment">% define some crystal directions</span>
h = Miller({1,0,0},{0,1,0},{0,0,1},cs,<span class="string">'uvw'</span>);

<span class="comment">% generate some figure</span>
fig = newMtexFigure(<span class="string">'layout'</span>,[4,3],<span class="string">'figSize'</span>,<span class="string">'huge'</span>);
subSet = 1:4;

<span class="comment">% plot pole figures for different strain steps</span>
<span class="keyword">for</span> n = subSet
  nextAxis
  plotPDF(odf{n},h,<span class="string">'lower'</span>,<span class="string">'contourf'</span>,<span class="string">'doNotDraw'</span>);
  ylabel(fig.children(end-2),[<span class="string">'\epsilon = '</span>,xnum2str(odf{n}.opt.strain)]);
<span class="keyword">end</span>
setColorRange(<span class="string">'equal'</span>)
mtexColorbar
</pre><img vspace="50" hspace="5" src="VPSCImport_02.png" alt=""> <h2 id="7">Visualize slip system activity</h2><p>Alongside with the orientation data VPSC also outputs a file <tt>ACT_PH1.OUT</tt> which contains the activity of the different slip systems during the deformation. Lets read this file as a table</p><pre class="codeinput">ACT = readtable([path2file filesep <span class="string">'ACT_PH1.OUT'</span>],<span class="string">'FileType'</span>,<span class="string">'text'</span>)
</pre><pre class="codeoutput">ACT =
  9&times;11 table
    STRAIN    AVACS    MODE1    MODE2    MODE3    MODE4    MODE5    MODE6    MODE7    MODE8    MODE9
    ______    _____    _____    _____    _____    _____    _____    _____    _____    _____    _____
        0     2.835    0.337     0.31    0.309    0.011    0.012    0.007    0.003    0.002    0.009
     0.25     2.766    0.312     0.23    0.417    0.009     0.01    0.007    0.005    0.003    0.009
      0.5     2.835    0.317    0.198    0.445    0.007    0.009    0.007    0.007    0.004    0.006
     0.75     2.825     0.31    0.131    0.513    0.005    0.007    0.006    0.015    0.007    0.006
        1     2.759    0.312    0.075    0.554    0.003    0.005    0.006    0.028    0.013    0.005
     1.25     2.746    0.327    0.053    0.546    0.002    0.004    0.005    0.041     0.02    0.002
      1.5     2.736     0.37    0.048    0.521    0.002    0.005    0.005    0.033    0.015    0.002
     1.75     2.739    0.394    0.046    0.503    0.002    0.005    0.005    0.031    0.013    0.003
        2     2.828    0.435    0.048    0.468    0.002    0.005    0.004    0.025    0.009    0.004
</pre><p>and plot the slip activity with respect to the strain for the different modes</p><pre class="codeinput"><span class="comment">% loop though the columns MODE1 ... MOD11</span>
close <span class="string">all</span>
<span class="keyword">for</span> n = 3: size(ACT,2)

  <span class="comment">% perform the plotting</span>
  plot(ACT.STRAIN, table2array(ACT(:,n)),<span class="string">'linewidth'</span>,2,<span class="keyword">...</span>
    <span class="string">'DisplayName'</span>,[<span class="string">'Slip mode '</span>,num2str(n-2)])
  hold <span class="string">on</span>;
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">% some styling</span>
xlabel(<span class="string">'Strain'</span>);
ylabel(<span class="string">'Slip activity'</span>);
legend(<span class="string">'show'</span>,<span class="string">'location'</span>,<span class="string">'NorthEastOutside'</span>);

set(gca,<span class="string">'Ylim'</span>,[-0.005 1])
set(gcf,<span class="string">'MenuBar'</span>,<span class="string">'none'</span>,<span class="string">'units'</span>,<span class="string">'normalized'</span>,<span class="string">'position'</span>,[0.25 0.25 0.5 0.5]);

<span class="comment">%for only one mode plot, e.g.,mode 3: cs = csapi(STRAIN,MODE{3});fnplt(cs,3,'color','b');hold off;</span>
</pre><img vspace="50" hspace="5" src="VPSCImport_03.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Import from VPSC
%
%%
% <https://public.lanl.gov/lebenso/ VPSC> is a crystal plasticity code
% originally written by Ricardo Lebensohn and Carlos Tome from Los Alamos
% National Laboratory - USA.
% 
% Original code can be requested to lebenso@lanl.gov
%
% https://public.lanl.gov/lebenso/
%
%% Import the orientations generated by VPSC
%
% Running a simulation in VPSC ussually results in an output file
% |TEX_PH1.OUT| which contains multiple sets of orientations for different
% strain levels. As these files does not contain any information on the
% crystal symmetry we need to specify it first

cs = crystalSymmetry('222', [4.762 10.225 5.994],'mineral', 'olivine');

%%
% In the next step the orientations are imported and converted into a list
% of <SO3Fun.SO3Fun.html ODFs> using the command <ODF.load.html |ODF.load|>.

% put in here the path to the VPSC output files
path2file = [mtexDataPath filesep 'VPSC'];

odf = ODF.load([path2file filesep 'TEX_PH1.OUT'],'halfwidth',10*degree,'CS',cs)

%%
% The individuel ODFs can be accessed by |odf{id}|

% lets plot the second ODF
plotSection(odf{2},'sigma','figSize','normal')

%%
% The information about the strain are stored as additional properties
% within each ODF variable

odf{1}.opt

%% Compare pole figures during deformation
%
% Next we examine the evaluation of the ODF during the deformation by
% plotting strain depended pole figures. 

% define some crystal directions
h = Miller({1,0,0},{0,1,0},{0,0,1},cs,'uvw');

% generate some figure
fig = newMtexFigure('layout',[4,3],'figSize','huge');
subSet = 1:4;

% plot pole figures for different strain steps
for n = subSet
  nextAxis
  plotPDF(odf{n},h,'lower','contourf','doNotDraw');
  ylabel(fig.children(end-2),['\epsilon = ',xnum2str(odf{n}.opt.strain)]);
end
setColorRange('equal')
mtexColorbar

%% Visualize slip system activity
% 
% Alongside with the orientation data VPSC also outputs a file
% |ACT_PH1.OUT| which contains the activity of the different slip systems
% during the deformation. Lets read this file as a table

ACT = readtable([path2file filesep 'ACT_PH1.OUT'],'FileType','text')

%%
% and plot the slip activity with respect to the strain for the different
% modes

% loop though the columns MODE1 ... MOD11
close all
for n = 3: size(ACT,2)
 
  % perform the plotting
  plot(ACT.STRAIN, table2array(ACT(:,n)),'linewidth',2,...
    'DisplayName',['Slip mode ',num2str(n-2)])
  hold on;
end
hold off

% some styling
xlabel('Strain');
ylabel('Slip activity');
legend('show','location','NorthEastOutside');

set(gca,'Ylim',[-0.005 1])
set(gcf,'MenuBar','none','units','normalized','position',[0.25 0.25 0.5 0.5]);

%for only one mode plot, e.g.,mode 3: cs = csapi(STRAIN,MODE{3});fnplt(cs,3,'color','b');hold off;
##### SOURCE END #####
--></body></html>