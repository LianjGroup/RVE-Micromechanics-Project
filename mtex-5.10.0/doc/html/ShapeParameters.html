
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Shape Parameters - Basic Properties</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-05-21"><meta name="DC.source" content="script_ShapeParameters.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Shape Parameters - Basic Properties</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Grain size vs. grain area and boundary size vs. perimeter</a></li><li><a href="#9">Radius, diameter, equivalent radius, equivalent perimeter and shape factor</a></li><li><a href="#14">Fractal Dimension</a></li></ul></div><p>In this section we discuss basic geometric properties of grains. Due to the huge amount of shape parameters we split them into different categories: basic properties (this page), <a href="EllipseBasedProperties.html">properties based on fitted ellipses</a>, <a href="HullBasedParameters.html">convex hull bases properties</a>, <a href="ProjectionBasesParameters.html">projection bases properties</a>. The table below summarizes the shape parameters discussed on this page.</p><p>
   <table class="usertable">
      <tr>
         <td>
               <p>
                  <tt>grainSize</tt>
               </p>
         </td>
         <td>
               <p>number of pixels per grain</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.area.html">
                     <tt>area</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>grain area in µm²</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.boundarySize.html">
                     <tt>boundarySize</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>number of boundary segments</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.perimeter.html">
                     <tt>perimeter</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>perimeter in µm</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.subBoundarySize.html">
                     <tt>subBoundarySize</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>number of inner boundaries</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.subBoundarySize.html">
                     <tt>subBoundaryLength</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>length of inner boundaries in <equation>
                     <img alt="$\mu m$" class="equation" height="10px"
                          src="0032258500_tmp_eq17376418037532559476.png"
                          width="22px"/>
                  </equation>
               </p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.diameter.html">
                     <tt>diameter</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>diameter in <equation>
                     <img alt="$\mu m$" class="equation" height="10px"
                          src="0319931406_tmp_eq17376418037532559476.png"
                          width="22px"/>
                  </equation>
               </p>
         </td>
         <td>
               <p>
                  <a href="grain2d.caliper.html">
                     <tt>caliper</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>caliper or Feret diameter</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.equivalentPerimeter.html">
                     <tt>equivalentPerimeter</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>perimeter of a circle with the same area</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.equivalentRadius.html">
                     <tt>equivalentRadius</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>radius of a circle with the same area</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.shapeFactor.html">
                     <tt>shapeFactor</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>perimeter / equivalent perimeter</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.isBoundary.html">
                     <tt>isBoundary</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>is it a boundary grain</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="IceSphericity.html">
                     <tt>sphericity</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>irregularity of grain boundary</p>
         </td>
         <td>
            <text/>
         </td>
         <td>
            <text/>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.hasHole.html">
                     <tt>hasHole</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>has inclusions</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.isInclusion.html">
                     <tt>isInclusion</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>is an inclusions</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.numNeighbors.html">
                     <tt>numNeighbors</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>number neighboring grains</p>
         </td>
         <td>
               <p>
                  <a href="triplePointList.triplePointList.html">
                     <tt>triplePoints</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>list of  triple points</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grainBoundary.grainBoundary.html">
                     <tt>boundary</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>list of  boundary segments</p>
         </td>
         <td>
               <p>
                  <a href="grainBoundary.grainBoundary.html">
                     <tt>innerBoundary</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>subgrain boundaries</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <tt>x</tt>, <tt>y</tt>
               </p>
         </td>
         <td>
               <p>coordinates of the vertices</p>
         </td>
         <td>
               <p>
                  <a href="grain2d.centroid.html">
                     <tt>centroid</tt>
                  </a>
               </p>
         </td>
         <td>
               <p>x,y coordinates of the barycenter</p>
         </td>
      </tr>
   </table>
</p><p>We start our discussion by reconstructing the grain structure from a sample EBSD data set.</p><pre class="codeinput"><span class="comment">% load sample EBSD data set</span>
mtexdata <span class="string">forsterite</span> <span class="string">silent</span>

<span class="comment">% restrict it to a subregion of interest.</span>
ebsd = ebsd(inpolygon(ebsd,[5 2 10 5]*10^3));

<span class="comment">% remove all not indexed pixels</span>
ebsd = ebsd(<span class="string">'indexed'</span>);

<span class="comment">% reconstruct grains</span>
[grains, ebsd.grainId] = calcGrains(ebsd,<span class="string">'angle'</span>,5*degree);

<span class="comment">% smooth them</span>
grains = smooth(grains,5);

<span class="comment">% plot the orientation data of the Forsterite phase</span>
plot(ebsd(<span class="string">'fo'</span>),ebsd(<span class="string">'fo'</span>).orientations)

<span class="comment">% plot the grain boundary on top of it</span>
hold <span class="string">on</span>
plot(grains.boundary,<span class="string">'lineWidth'</span>,2)
hold <span class="string">off</span>
</pre><img vspace="50" hspace="5" src="ShapeParameters_01.png" alt=""> <h2 id="3">Grain size vs. grain area and boundary size vs. perimeter</h2><p>The most basic properties are grainSize and grain area. Those can be computed by</p><pre class="codeinput">grains(9).grainSize
grains(9).area
</pre><pre class="codeoutput">ans =
     1
ans =
   1.9540e+03
</pre><p>Hereby <tt>grainSize</tt> referes to the number of pixels that belong to a certain grain while <tt>area</tt> represents the actual area measured in <tt>(&micro;m)^2</tt>. We may analyze the distribution of grains by grain area using a histogram.</p><pre class="codeinput">close <span class="string">all</span>
histogram(grains.area)
xlabel(<span class="string">'grain area'</span>)
ylabel(<span class="string">'number of grains'</span>)
</pre><img vspace="50" hspace="5" src="ShapeParameters_02.png" alt=""> <p>Note the large amount of very small grains. A more realistic histogram we obtain if we do not plot the number of grains at the y-axis but its total area. This can be achieved with the command <a href="grain2d.histogram.html"><tt>histogram(grains)</tt></a> or <a href="grain2d.hist.html"><tt>hist(grains)</tt></a></p><pre class="codeinput">hist(grains)
</pre><img vspace="50" hspace="5" src="ShapeParameters_03.png" alt=""> <pre class="codeinput">histogram(grains)
</pre><img vspace="50" hspace="5" src="ShapeParameters_04.png" alt=""> <p>Simarly as <tt>grainSize</tt> and <tt>area</tt>, the one-dimensional meassures <tt>boundarySize</tt> and <tt>perimeter</tt> give the length of the grain boundary as number of segments and in <tt>&micro;m</tt>, respectively.</p><pre class="codeinput">grains(9).boundarySize
grains(9).perimeter
</pre><pre class="codeoutput">ans =
     4
ans =
  233.1561
</pre><p>We may compute these quantities also explicitely from the grain boundary segents. In the following code the first command returns simply the number of boundary segments while the second one gives the total length of the boundary by summing up the length of each individual boundary segment</p><pre class="codeinput">length(grains(9).boundary)
sum(grains(9).boundary.segLength)
</pre><pre class="codeoutput">ans =
     4
ans =
  233.1561
</pre><h2 id="9">Radius, diameter, equivalent radius, equivalent perimeter and shape factor</h2><p>Another, one dimensional measure is the <tt>diameter</tt> which refers to the longest distance between any two boundary points and is given im <tt>&micro;m</tt> as well</p><pre class="codeinput">grains(9).diameter
</pre><pre class="codeoutput">ans =
  106.0660
</pre><p>The diameter is a special case of the caliper or Feret diameter of a grain that is explained in detail in the section <a href="ProjectionBasedParameters.html">Projection based parameters</a>.</p><p>In contrast the <a href="grain2d.equivalentRadius.html">equivalent radius</a> is the radius of a circle with the same area as the grain. Naturally, the equivalent radius is always smaller than the actual radius of the grains. Similarly, the <a href="grain2d.equivalentPerimeter">equivalent perimeter</a> is defined as the perimeter of the circle the same area and is always smaller then the actual perimeter.</p><pre class="codeinput">2*grains(9).equivalentRadius

grains(9).equivalentPerimeter
</pre><pre class="codeoutput">ans =
   49.8787
ans =
  156.6986
</pre><p>As a consequence, the ratio between between actual grain perimeter and the equivalent perimeter, the so called shape factor, is always larger then 1. The <a href="grain2d.shapeFactor.html"><tt>shapeFactor</tt></a> amd measures how different a certain shape is from a circle.</p><pre class="codeinput">plot(grains,grains.shapeFactor)
mtexColorbar(<span class="string">'title'</span>,<span class="string">'shape factor'</span>)
</pre><img vspace="50" hspace="5" src="ShapeParameters_05.png" alt=""> <p>A second measure for the discrepancy between the actual shape and a circle is the relative difference between the <a href="grain2d.perimeter.html"><tt>perimeter</tt></a> and the <a href="grain2d.equivalentPerimeter.html"><tt>equivalentPerimeter</tt></a></p><pre class="codeinput">plot(grains,(grains.perimeter - grains.equivalentPerimeter)./grains.perimeter)
setColorRange([0,0.5])
mtexColorbar
</pre><img vspace="50" hspace="5" src="ShapeParameters_06.png" alt=""> <p>In this plot round shapes will have values close to zero while concave shapes will get values up to <img src="ShapeParameters_eq08200310771530261272.png" alt="$0.5$">.</p><p>A third measure is the <a href="grain2d.paris.html"><tt>paris</tt></a> which stands for Percentile Average Relative Indented Surface and gives the relative difference between the actual perimeter and the perimeter of the convex hull. It is explained in more detail in the section <a href="HullBasedParameters.html">convex hull parameters.</a></p><pre class="codeinput">plot(grains,grains.paris)
mtexColorbar(<span class="string">'title'</span>,<span class="string">'paris'</span>)
</pre><img vspace="50" hspace="5" src="ShapeParameters_07.png" alt=""> <h2 id="14">Fractal Dimension</h2><p>The fractal dimension of grain boundaries has been used to characterize the conditions of dynamical recrystallization. One way to define the fractal dimension of grain boundaries is to look at the slope of the perimeter as a function of the <a href="grain2d.equivalentRadius.html">equivalent radius</a> of the grains. More precisely, we consider this relationship in a log log plot and fit a linear model.</p><pre class="codeinput"><span class="comment">% consider the entire data set</span>
mtexdata <span class="string">forsterite</span> <span class="string">silent</span>

<span class="comment">% reconstruct grains</span>
grains = calcGrains(ebsd(<span class="string">'indexed'</span>));

<span class="comment">% smooth them</span>
grains = smooth(grains,5);

close <span class="string">all</span>
scatter(grains.equivalentRadius,grains.perimeter)
xlabel(<span class="string">'equivalent radius'</span>)
ylabel(<span class="string">'perimeter'</span>)

<span class="comment">% set axes to logarithmic</span>
logAxis(gca, [10,10^4],[10^2,10^5])

<span class="comment">% fit a linear function in log space</span>
ab = polyfit(log(grains.equivalentRadius),log(grains.perimeter),1);

<span class="comment">% plot it</span>
hold <span class="string">on</span>
plot([10,10^4],exp(ab(2) + ab(1) * log([10,10^4])),<span class="string">'LineWidth'</span>,3)
hold <span class="string">off</span>
</pre><img vspace="50" hspace="5" src="ShapeParameters_08.png" alt=""> <p>The slope of the linear function is the fractal dimension.</p><pre class="codeinput">fractalDimension = ab(1)
</pre><pre class="codeoutput">fractalDimension =
    1.0338
</pre><p>It is important to understand that the fractal dimension computed this way heavily depends on the smoothing applied to the grain boundaries.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Shape Parameters - Basic Properties
%
%%
% In this section we discuss basic geometric properties of grains. Due to
% the huge amount of shape parameters we split them into different
% categories: basic properties (this page), <EllipseBasedProperties.html
% properties based on fitted ellipses>, <HullBasedParameters.html convex
% hull bases properties>, <ProjectionBasesParameters.html projection bases
% properties>. The table below summarizes the shape parameters discussed on
% this page.
%
% 
% <html>
%    <table class="usertable">
%       <tr>
%          <td>
%                <p>
%                   <tt>grainSize</tt>
%                </p>
%          </td>
%          <td>
%                <p>number of pixels per grain</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.area.html">
%                      <tt>area</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>grain area in µm²</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.boundarySize.html">
%                      <tt>boundarySize</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>number of boundary segments</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.perimeter.html">
%                      <tt>perimeter</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>perimeter in µm</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.subBoundarySize.html">
%                      <tt>subBoundarySize</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>number of inner boundaries</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.subBoundarySize.html">
%                      <tt>subBoundaryLength</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>length of inner boundaries in <equation>
%                      <img alt="$\mu m$" class="equation" height="10px"
%                           src="0032258500_tmp_eq17376418037532559476.png"
%                           width="22px"/>
%                   </equation>
%                </p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.diameter.html">
%                      <tt>diameter</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>diameter in <equation>
%                      <img alt="$\mu m$" class="equation" height="10px"
%                           src="0319931406_tmp_eq17376418037532559476.png"
%                           width="22px"/>
%                   </equation>
%                </p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.caliper.html">
%                      <tt>caliper</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>caliper or Feret diameter</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.equivalentPerimeter.html">
%                      <tt>equivalentPerimeter</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>perimeter of a circle with the same area</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.equivalentRadius.html">
%                      <tt>equivalentRadius</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>radius of a circle with the same area</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.shapeFactor.html">
%                      <tt>shapeFactor</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>perimeter / equivalent perimeter</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.isBoundary.html">
%                      <tt>isBoundary</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>is it a boundary grain</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="IceSphericity.html">
%                      <tt>sphericity</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>irregularity of grain boundary</p>
%          </td>
%          <td>
%             <text/>
%          </td>
%          <td>
%             <text/>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.hasHole.html">
%                      <tt>hasHole</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>has inclusions</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.isInclusion.html">
%                      <tt>isInclusion</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>is an inclusions</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grain2d.numNeighbors.html">
%                      <tt>numNeighbors</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>number neighboring grains</p>
%          </td>
%          <td>
%                <p>
%                   <a href="triplePointList.triplePointList.html">
%                      <tt>triplePoints</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>list of  triple points</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <a href="grainBoundary.grainBoundary.html">
%                      <tt>boundary</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>list of  boundary segments</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grainBoundary.grainBoundary.html">
%                      <tt>innerBoundary</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>subgrain boundaries</p>
%          </td>
%       </tr>
%       <tr>
%          <td>
%                <p>
%                   <tt>x</tt>, <tt>y</tt>
%                </p>
%          </td>
%          <td>
%                <p>coordinates of the vertices</p>
%          </td>
%          <td>
%                <p>
%                   <a href="grain2d.centroid.html">
%                      <tt>centroid</tt>
%                   </a>
%                </p>
%          </td>
%          <td>
%                <p>x,y coordinates of the barycenter</p>
%          </td>
%       </tr>
%    </table>
% </html>
% 
%
%%
% We start our discussion by reconstructing the grain structure from a
% sample EBSD data set.

% load sample EBSD data set
mtexdata forsterite silent

% restrict it to a subregion of interest.
ebsd = ebsd(inpolygon(ebsd,[5 2 10 5]*10^3));

% remove all not indexed pixels
ebsd = ebsd('indexed');

% reconstruct grains
[grains, ebsd.grainId] = calcGrains(ebsd,'angle',5*degree);

% smooth them
grains = smooth(grains,5);

% plot the orientation data of the Forsterite phase
plot(ebsd('fo'),ebsd('fo').orientations)

% plot the grain boundary on top of it
hold on
plot(grains.boundary,'lineWidth',2)
hold off


%% Grain size vs. grain area and boundary size vs. perimeter
%
% The most basic properties are grainSize and grain area. Those can be
% computed by

grains(9).grainSize
grains(9).area

%%
% Hereby |grainSize| referes to the number of pixels that belong to a
% certain grain while |area| represents the actual area measured in
% |(µm)^2|. We may analyze the distribution of grains by grain area using a
% histogram.

close all
histogram(grains.area)
xlabel('grain area')
ylabel('number of grains')

%%
% Note the large amount of very small grains. A more realistic histogram we
% obtain if we do not plot the number of grains at the y-axis but its total
% area. This can be achieved with the command <grain2d.histogram.html
% |histogram(grains)|> or <grain2d.hist.html |hist(grains)|>

hist(grains)

%%

histogram(grains)

%%
% Simarly as |grainSize| and |area|, the one-dimensional meassures
% |boundarySize| and |perimeter| give the length of the grain boundary as
% number of segments and in |µm|, respectively.

grains(9).boundarySize
grains(9).perimeter

%%
% We may compute these quantities also explicitely from the grain boundary
% segents. In the following code the first command returns simply the
% number of boundary segments while the second one gives the total length
% of the boundary by summing up the length of each individual boundary
% segment

length(grains(9).boundary)
sum(grains(9).boundary.segLength)


%% Radius, diameter, equivalent radius, equivalent perimeter and shape factor
%
% Another, one dimensional measure is the |diameter| which refers to the
% longest distance between any two boundary points and is given im |µm| as
% well

grains(9).diameter

%%
% The diameter is a special case of the caliper or Feret diameter of a
% grain that is explained in detail in the section
% <ProjectionBasedParameters.html Projection based parameters>.
%
% In contrast the <grain2d.equivalentRadius.html equivalent radius> is the
% radius of a circle with the same area as the grain. Naturally, the
% equivalent radius is always smaller than the actual radius of the grains.
% Similarly, the <grain2d.equivalentPerimeter equivalent perimeter> is
% defined as the perimeter of the circle the same area and is always
% smaller then the actual perimeter.

2*grains(9).equivalentRadius

grains(9).equivalentPerimeter

%%
% As a consequence, the ratio between between actual grain perimeter and
% the equivalent perimeter, the so called shape factor, is always larger
% then 1. The <grain2d.shapeFactor.html |shapeFactor|> amd measures how
% different a certain shape is from a circle.

plot(grains,grains.shapeFactor)
mtexColorbar('title','shape factor')

%% 
% A second measure for the discrepancy between the actual shape and a
% circle is the relative difference between the <grain2d.perimeter.html
% |perimeter|> and the <grain2d.equivalentPerimeter.html
% |equivalentPerimeter|>

plot(grains,(grains.perimeter - grains.equivalentPerimeter)./grains.perimeter)
setColorRange([0,0.5])
mtexColorbar

%%
% In this plot round shapes will have values close to zero while concave
% shapes will get values up to $0.5$. 
%
% A third measure is the <grain2d.paris.html |paris|> which stands for
% Percentile Average Relative Indented Surface and gives the relative
% difference between the actual perimeter and the perimeter of the convex
% hull. It is explained in more detail in the section
% <HullBasedParameters.html convex hull parameters.>

plot(grains,grains.paris)
mtexColorbar('title','paris')

%% Fractal Dimension
%
% The fractal dimension of grain boundaries has been used to characterize
% the conditions of dynamical recrystallization. One way to define the
% fractal dimension of grain boundaries is to look at the slope of the
% perimeter as a function of the <grain2d.equivalentRadius.html equivalent
% radius> of the grains. More precisely, we consider this relationship in a
% log log plot and fit a linear model. 

% consider the entire data set
mtexdata forsterite silent

% reconstruct grains
grains = calcGrains(ebsd('indexed'));

% smooth them
grains = smooth(grains,5);

close all
scatter(grains.equivalentRadius,grains.perimeter)
xlabel('equivalent radius')
ylabel('perimeter')

% set axes to logarithmic
logAxis(gca, [10,10^4],[10^2,10^5])

% fit a linear function in log space
ab = polyfit(log(grains.equivalentRadius),log(grains.perimeter),1);

% plot it 
hold on
plot([10,10^4],exp(ab(2) + ab(1) * log([10,10^4])),'LineWidth',3)
hold off

%%
% The slope of the linear function is the fractal dimension.

fractalDimension = ab(1)

%%
% It is important to understand that the fractal dimension computed this
% way heavily depends on the smoothing applied to the grain boundaries.

##### SOURCE END #####
--></body></html>