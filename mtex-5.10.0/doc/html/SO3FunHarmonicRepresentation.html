
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Harmonic Representation of Rotational Functions</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-05-21"><meta name="DC.source" content="script_SO3FunHarmonicRepresentation.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Harmonic Representation of Rotational Functions</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#4">Fourier Coefficients</a></li><li><a href="#8">ODFs given by Fourier coefficients</a></li><li><a href="#10">TODO: Add some non ODF example for an SO3Fun</a></li></ul></div><p>Similarly as periodic functions may be represented as weighted sums of sines and cosines a rotational function $f\colon \mathcal{SO}(3)\toC$ can be written as a series of the form</p><pre class="error">Error updating Text.

 String scalar or character vector must have valid interpreter syntax: 
$f\colon \mathcal{SO}(3)\toC$
</pre><p><img src="SO3FunHarmonicRepresentation_eq06545720807249565869.png" alt="$$ f({\bf R}) = \sum_{n=0}^N \sum_{k,l = -n}^n \hat f_n^{k,l} \, \mathrm{D}_n^{k,l}({\bf R}) $$"></p><p>with respect to Fourier coefficients <img src="SO3FunHarmonicRepresentation_eq02338059136524894020.png" alt="$\hat f_n^{k,l}$"> and the so called <a href="WignerFunctions.html">Wigner-D functions</a> <img src="SO3FunHarmonicRepresentation_eq04306431420537851092.png" alt="$D_n^{k,l}$">.</p><p>There exists various normalizations for the <a href="WignerFunctions.html">Wigner-D functions</a>. In MTEX they are <img src="SO3FunHarmonicRepresentation_eq00704031345446614743.png" alt="$L_2$"> normalized, which means</p><p><img src="SO3FunHarmonicRepresentation_eq01828590350747269980.png" alt="$$\| D_n^{k,l} \|_2 = 1$$"></p><p>for all <img src="SO3FunHarmonicRepresentation_eq16432741107138008444.png" alt="$n,k,l$">. For more information take a look on <a href="WignerFunctions.html">Wigner-D functions</a> and <a href="SO3FunOperations.html#6">Integration of SO3Fun's</a>.</p><p>We construct an arbitrary ODF which generally is an SO3Fun:</p><pre class="codeinput">mtexdata <span class="string">dubna</span>
odf = calcODF(pf,<span class="string">'resolution'</span>,5*degree,<span class="string">'zero_Range'</span>)
</pre><pre class="codeoutput"> 
pf = PoleFigure (xyz)
  crystal symmetry : Quartz (321, X||a*, Y||b, Z||c*)
 
  h = (02-21), r = 72 x 19 points
  h = (10-10), r = 72 x 19 points
  h = (10-11)(01-11), r = 72 x 19 points
  h = (10-12), r = 72 x 19 points
  h = (11-20), r = 72 x 19 points
  h = (11-21), r = 72 x 19 points
  h = (11-22), r = 72 x 19 points
 
odf = SO3FunRBF (Quartz &#8594; xyz)
 
  &lt;strong&gt;multimodal components&lt;/strong&gt;
  kernel: de la Vallee Poussin, halfwidth 5&deg;
  center: 19848 orientations, resolution: 5&deg;
  weight: 1
 
</pre><p>Now we may transform an arbitrary SO3Fun into its Fourier representation using the command <a href="SO3FunHarmonic.SO3FunHarmonic.html">SO3FunHarmonic</a></p><pre class="codeinput">f = SO3FunHarmonic(odf,<span class="string">'bandwidth'</span>,32)
</pre><pre class="codeoutput"> 
f = SO3FunHarmonic (Quartz &#8594; xyz)
  isReal: true
  bandwidth: 32
  weight: 1
 
</pre><h2 id="4">Fourier Coefficients</h2><p>Within the class <tt><a href="SO3FunHarmonic.SO3FunHarmonic.html">SO3FunHarmonic</a></tt> rotational functions are represented by their complex valued Fourier coefficients which are stored in the field <tt>fun.fhat</tt>. They are stored in a linear order, which means <tt>f.fhat(1)</tt> is the zero order Fourier coefficient, <tt>f.fhat(2:10)</tt> are the first order Fourier coefficients that form a 3x3 matrix and so on. Accordingly, we can extract the second order Fourier coefficients by</p><pre class="codeinput">reshape(f.fhat(11:35),5,5)
</pre><pre class="codeoutput">ans =
  Columns 1 through 4
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0595 - 0.1759i   0.6216 - 0.3734i   0.8788 + 0.0000i   0.6216 + 0.3734i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
  Column 5
   0.0000 + 0.0000i
   0.0000 + 0.0000i
   0.0595 + 0.1759i
   0.0000 + 0.0000i
   0.0000 + 0.0000i
</pre><p>As an additional example lets define a harmonic function by its Fourier coefficients <img src="SO3FunHarmonicRepresentation_eq10441287032308042751.png" alt="$\hat f_0^{0,0} = 0.5$"> and <img src="SO3FunHarmonicRepresentation_eq16053295194561943153.png" alt="$\hat f_1 = \begin{array}{rrr} 1 &amp; 4 &amp; 7 \\ 2 &amp; 5 &amp; 8 \\ 3 &amp; 6 &amp; 9 \\ \end{array}$"></p><pre class="codeinput">f2 = SO3FunHarmonic([0.5,1:9]')

plot(f2)
</pre><pre class="codeoutput"> 
f2 = SO3FunHarmonic (xyz &#8594; xyz)
  bandwidth: 1
  weight: 0.5
 
</pre><img vspace="50" hspace="5" src="SO3FunHarmonicRepresentation_01.png" alt=""> <p>The Fourier coefficients <img src="SO3FunHarmonicRepresentation_eq02338059136524894020.png" alt="$\hat f_n^{k,l}$"> allow us a complete characterization of the rotational function. They are of particular importance for the calculation of mean macroscopic properties e.g. the second order Fourier coefficients characterize thermal expansion, optical refraction index, and electrical conductivity whereas the fourth order Fourier coefficients characterize the elastic properties of the specimen.</p><p>Moreover, the decay of the Fourier coefficients is directly related to the smoothness of the SO3Fun. The decay of the Fourier coefficients might also hint for the presents of a ghost effect. See <a href="PoleFigure2ODFGhostCorrection.html">Ghost Correction</a>.</p><p>The decay of the Fourier coefficients is shown in the plot</p><pre class="codeinput">close <span class="string">all</span>;
plotSpektra(f)
</pre><img vspace="50" hspace="5" src="SO3FunHarmonicRepresentation_02.png" alt=""> <h2 id="8">ODFs given by Fourier coefficients</h2><p>In order to define an ODF by it <b>Fourier coefficients</b> <img src="SO3FunHarmonicRepresentation_eq09188560032834678209.png" alt="${\bf \hat{f}}$">, they has to be given as a literally ordered, complex valued vector of the form</p><p><img src="SO3FunHarmonicRepresentation_eq12614511767076916659.png" alt="$$ {\bf \hat{f}} = [\hat{f}_0^{0,0},\hat{f}_1^{-1,-1},\ldots,\hat{f}_1^{1,1},\hat{f}_2^{-2,-2},\ldots,\hat{f}_N^{N,N}] $$"></p><p>where <img src="SO3FunHarmonicRepresentation_eq17093129554216609349.png" alt="$n=0,\ldots,N$"> denotes the order of the Fourier coefficients.</p><pre class="codeinput">cs   = crystalSymmetry(<span class="string">'1'</span>);    <span class="comment">% crystal symmetry</span>
fhat = [1;reshape(eye(3),[],1);reshape(eye(5),[],1)]; <span class="comment">% Fourier coefficients</span>
odf = SO3FunHarmonic(fhat,cs)

plot(odf,<span class="string">'sections'</span>,6,<span class="string">'silent'</span>,<span class="string">'sigma'</span>)
</pre><pre class="codeoutput"> 
odf = SO3FunHarmonic (1 &#8594; xyz)
  antipodal: true
  isReal: true
  bandwidth: 2
  weight: 1
 
</pre><img vspace="50" hspace="5" src="SO3FunHarmonicRepresentation_03.png" alt=""> <pre class="codeinput">plotPDF(odf,[Miller(1,0,0,cs),Miller(1,1,0,cs)],<span class="string">'antipodal'</span>)
</pre><img vspace="50" hspace="5" src="SO3FunHarmonicRepresentation_04.png" alt=""> <h2 id="10">TODO: Add some non ODF example for an SO3Fun</h2><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Harmonic Representation of Rotational Functions
%

%%
% Similarly as periodic functions may be represented as weighted sums of
% sines and cosines a rotational function $f\colon \mathcal{SO}(3)\toC$ 
% can be written as a series of the form
%
% $$ f({\bf R}) = \sum_{n=0}^N \sum_{k,l = -n}^n \hat f_n^{k,l} \, \mathrm{D}_n^{k,l}({\bf R}) $$
%
% with respect to Fourier coefficients $\hat f_n^{k,l}$ and the so called
% <WignerFunctions.html Wigner-D functions> $D_n^{k,l}$.
% 
% There exists various normalizations for the <WignerFunctions.html Wigner-D functions>. 
% In MTEX they are $L_2$ normalized, which means
%
% $$\| D_n^{k,l} \|_2 = 1$$
%
% for all $n,k,l$. For more information take a look on 
% <WignerFunctions.html Wigner-D functions> and 
% <SO3FunOperations.html#6 Integration of SO3Fun's>.
%
%%
%
% We construct an arbitrary ODF which generally is an SO3Fun:
mtexdata dubna
odf = calcODF(pf,'resolution',5*degree,'zero_Range')
%%
% Now we may transform an arbitrary SO3Fun into its Fourier representation 
% using the command <SO3FunHarmonic.SO3FunHarmonic.html SO3FunHarmonic> 

f = SO3FunHarmonic(odf,'bandwidth',32)

%% Fourier Coefficients
%
% Within the class |<SO3FunHarmonic.SO3FunHarmonic.html SO3FunHarmonic>| rotational functions are represented by
% their complex valued Fourier coefficients which are stored in the field 
% |fun.fhat|. 
% They are stored in a linear order, which means |f.fhat(1)| is the
% zero order Fourier coefficient, |f.fhat(2:10)| are the first order
% Fourier coefficients that form a 3x3 matrix and so on.
% Accordingly, we can extract the second order Fourier coefficients by

reshape(f.fhat(11:35),5,5)

%%
% As an additional example lets define a harmonic function by its Fourier
% coefficients $\hat f_0^{0,0} = 0.5$ and 
% $\hat f_1 = \begin{array}{rrr} 
% 1 & 4 & 7 \\ 
% 2 & 5 & 8 \\ 
% 3 & 6 & 9 \\ 
% \end{array}$

f2 = SO3FunHarmonic([0.5,1:9]')

plot(f2)
%%
% The Fourier coefficients $\hat f_n^{k,l}$ allow us a complete 
% characterization of the rotational function. They are of particular 
% importance for the calculation of mean macroscopic properties e.g. 
% the second order Fourier coefficients characterize thermal expansion, 
% optical refraction index, and electrical conductivity whereas the 
% fourth order Fourier coefficients characterize the elastic properties 
% of the specimen.
%
% Moreover, the decay of the Fourier coefficients is directly related to
% the smoothness of the SO3Fun. The decay of the Fourier coefficients might
% also hint for the presents of a ghost effect. See
% <PoleFigure2ODFGhostCorrection.html Ghost Correction>.

%%
% The decay of the Fourier coefficients is shown in the plot
close all;
plotSpektra(f)


%% ODFs given by Fourier coefficients
%
% In order to define an ODF by it *Fourier coefficients* ${\bf \hat{f}}$, 
% they has to be given as a literally ordered, complex valued
% vector of the form
%
% $$ {\bf \hat{f}} = [\hat{f}_0^{0,0},\hat{f}_1^{-1,-1},\ldots,\hat{f}_1^{1,1},\hat{f}_2^{-2,-2},\ldots,\hat{f}_N^{N,N}] $$
%
% where $n=0,\ldots,N$ denotes the order of the Fourier coefficients.

cs   = crystalSymmetry('1');    % crystal symmetry
fhat = [1;reshape(eye(3),[],1);reshape(eye(5),[],1)]; % Fourier coefficients
odf = SO3FunHarmonic(fhat,cs)

plot(odf,'sections',6,'silent','sigma')

%%

plotPDF(odf,[Miller(1,0,0,cs),Miller(1,1,0,cs)],'antipodal')

%% TODO: Add some non ODF example for an SO3Fun
%
%


##### SOURCE END #####
--></body></html>